(()=>{"use strict";customElements.define("fancy-background",class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}).innerHTML='\n\t\t<style>\n\t\t\t@import "./styles/fancy-background.css";\n\t\t</style>\n\t\t<div id="background">\n\t\t\t<svg id="fregio" viewBox="0,0,100,100" preserveAspectRatio="none">\n\t\t\t\t<polyline points="0,0 20,100 40,0" style="fill:rgba(255,0,0,.5);stroke:none;" />\n\t\t\t\t<polyline points="20,0 40,100 60,0" style="fill:rgba(255,255,0,.5);stroke:none;" />\n\t\t\t\t<polyline points="40,0 60,100 80,0" style="fill:rgba(255,0,255,.5);stroke:none;" />\n\t\t\t\t<polyline points="60,0 80,100 100,0" style="fill:rgba(0,255,255,.5);stroke:none;" />\n\t\t\t\t<polyline points="80,0 100,100 100,0" style="fill:rgba(0,255,0,.5);stroke:none;" />\n\t\t\t</svg>\n\t\t</div>\n\t\t'}connectedCallback(){this.hasAttribute("thickness")&&this.style.setProperty("--thickness",this.getAttribute("side"))}}),customElements.define("main-toolbar",class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}).innerHTML='\n\t\t<style>\n\t\t\t@import "./styles/main-toolbar.css";\n\t\t</style>\n\t\t<div id="toolbar">\n\t\t\t<span class="spacer"></span>\n\t\t\t<img src="./images/icons/elefanticon.svg"></img>\n\t\t\t<span class="spacer"></span>\n\t\t\t<div>SimpleOrigami</div>\n\t\t\t<span class="fill-spacer"></span>\n\t\t\t<img id="main-button" src="./images/icons/menu.svg"></img>\n\t\t\t<span class="spacer"></span>\n\t\t</div>\n\t\t'}connectedCallback(){this.hasAttribute("thickness")&&this.style.setProperty("--thickness",this.getAttribute("side")),this.button=this.shadowRoot.querySelector("#main-button")}setButtonClickCallback(t){this.button.addEventListener("click",t)}}),customElements.define("side-button",class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}).innerHTML='\n\t\t<style>\n\t\t\t@import "./styles/side-button.css";\n\t\t</style>\n\t\t<div class="button">\n\t\t\t<svg height="100%" width="100%" viewBox="0,0,20,20">\n\t\t  \t<polyline id="left" points="12,1 4,10 12,19" style="fill:none;stroke:rgba(255,255,255,.5);stroke-width:1;stroke-linecap:round" />\n\t\t\t\t<polyline id="right" points="8,1 16,10 8,19" style="fill:none;stroke:rgba(255,255,255,.5);stroke-width:1;stroke-linecap:round" />\n\t\t\t\t<polyline id="up" points="1,16 10,8 19,16" style="fill:none;stroke:rgba(255,255,255,.5);stroke-width:1;stroke-linecap:round" />\n\t\t\t\t<polyline id="down" points="1,8 10,16 19,8" style="fill:none;stroke:rgba(255,255,255,.5);stroke-width:1;stroke-linecap:round" />\n\t\t\t</svg>\n\t\t</div>\n\t\t'}connectedCallback(){let t=this.getAttribute("side");this.shadowRoot.querySelector("div").classList.add(t);for(let e of this.shadowRoot.querySelectorAll("polyline"))e.id==t?e.setAttribute("visibility","visible"):e.setAttribute("visibility","hidden")}}),customElements.define("sliding-panel",class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}).innerHTML='\n\t\t<style>\n\t\t\t@import "./styles/sliding-panel.css";\n\t\t</style>\n\t\t<div class="panel"></div>\n\t\t',this.panel,this.total,this.onScreen=1,this.spacing,this.bounds,this.deckOnView=!0,this.deckSliding=!1,this.layout="horizontal",this.limit={visible:"0px",hidden:"100%"},this.shadow="none"}connectedCallback(){this.panel=this.shadowRoot.querySelector(".panel"),this.addEventListener("transitionstart",(()=>{this.deckSliding=!0})),this.addEventListener("transitionend",(()=>{this.deckSliding=!1})),this.parseAttributes()}parseAttributes(){let t=this.getAttribute("elements").trim().split(" ").map((t=>Number(t)));if(this.total=t[0],t.length>1&&(this.onScreen=t[1]),this.spacing=Number(this.getAttribute("spacing")),this.bounds=this.onScreen%2==0?[-this.total*this.spacing+this.spacing*this.onScreen,0]:[-this.total*this.spacing+this.spacing*(this.onScreen-Math.floor(this.onScreen/2)),this.spacing*(this.onScreen-1)/2],this.hasAttribute("layout")&&(this.layout=this.getAttribute("layout")),this.panel.classList.add(this.layout),this.hasAttribute("limit")){let t=this.getAttribute("limit").trim().split(" ");this.limit={visible:t[0],hidden:t[1]},this.panel.style.top=this.limit.visible}if(this.hasAttribute("hide")&&(this.panel.style.top=this.limit.hidden,this.deckOnView=!1),this.jump(this.currentIndex),this.panel.classList.add("slidable"),this.hasAttribute("color")&&this.style.setProperty("--background-color",this.getAttribute("color")),this.hasAttribute("shadow")){let t=this.getAttribute("shadow").trim().split(" ");this.panel.classList.add(`shadow-${t[0]}`),t.length>1&&this.style.setProperty("--shadow-color",t[1]),t.length>2&&this.style.setProperty("--shadow-dimension",t[2])}}clearPanel(){this.panel.innerHTML="",this.parseAttributes()}addElement(t){this.panel.append(t)}forward(){switch(this.layout){case"horizontal":this.deckOnView&&this.slide(-this.spacing)}}backward(){switch(this.layout){case"horizontal":this.deckOnView&&this.slide(this.spacing)}}slide(t){let e=this.evaluatePosition(t);void 0!==e?this.panel.style.left=`${e}px`:this.shake()}evaluatePosition(t){let e=!1;if(t>0?e=parseFloat(this.panel.style.left)<this.bounds[1]&&this.deckOnView:t<0&&(e=parseFloat(this.panel.style.left)>this.bounds[0]&&this.deckOnView),e){let e=parseFloat(this.panel.style.left)+t;return e>this.bounds[1]?e=this.bounds[1]:e<this.bounds[0]&&(e=this.bounds[0]),e}}roundIndex(){let t=Math.round(-parseFloat(this.panel.style.left)/this.spacing)+this.onScreen-this.onScreen%2;return this.onScreen%2==0&&(t=t-this.onScreen+1),t}jump(t){t>=0&&t<=this.total&&(this.panel.style.left=`${-t*this.spacing+this.bounds[1]}px`)}toggle(){this.deckOnView?(this.panel.style.top=this.limit.hidden,this.deckOnView=!1):(this.panel.style.top=this.limit.visible,this.deckOnView=!0)}shake(){this.panel.classList.add("shake"),setTimeout((()=>{this.panel.classList.remove("shake")}),820)}}),customElements.define("card-deck",class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}).innerHTML='\n\t\t<style>\n\t\t\t@import "./styles/card-deck.css";\n\t\t</style>\n\t\t',this.cardType,this.deck,this.data=null,this.slides,this.slideNumber,this.slidesOnScreen,this.slideSize,this.currentSlide,this.slideMargin,this.spacing}connectedCallback(){this.cardType=this.getAttribute("card"),this.deck=document.createElement("sliding-panel"),this.deck.id=`${this.id}-panel`;let t=this.getBoundingClientRect().width,e=.8*this.getBoundingClientRect().height,s=.8*t;this.slideWidth=s,this.slideHeight=e,this.slideSize=Math.min(.8*e,s),this.currentSlide=0,this.hasAttribute("wallet")?(this.slidesOnScreen=1,this.slideMargin=.5*(t/this.slidesOnScreen-this.slideWidth),this.spacing=this.slideWidth+2*this.slideMargin):(this.slidesOnScreen=Math.floor(t/(1.1*this.slideSize)),this.slideMargin=.5*(t/this.slidesOnScreen-this.slideSize),this.spacing=this.slideSize+2*this.slideMargin),this.deck.setAttribute("elements",`1 ${this.slidesOnScreen}`),this.deck.setAttribute("spacing",this.spacing),this.deck.setAttribute("limit",this.getAttribute("limit")),this.deck.setAttribute("color",this.getAttribute("color")),this.hasAttribute("shadow")&&this.deck.setAttribute("shadow",this.getAttribute("shadow")),this.hasAttribute("hide")&&this.deck.setAttribute("hide",!0),this.shadowRoot.append(this.deck)}setup(t,e=0){if(this.hasAttribute("wallet")){this.data=t,this.slides=[],this.slideNumber=Object.keys(t).length,this.deck.setAttribute("elements",`${this.slideNumber} ${this.slidesOnScreen}`),this.deck.clearPanel();for(let t of Object.keys(this.data)){let e=this.data[t],s=document.createElement(this.cardType);s.setAttribute("slot",t),s.setAttribute("side",`${this.slideWidth}px ${this.slideHeight}px`),s.style.margin=`0 ${this.slideMargin}px`,this.deck.addElement(s),s.setContent(e),this.slides.push(s)}this.jump(0)}else if(t.uid!=this.data?.uid){this.data=t,this.slides=[],this.slideNumber=t.steps.length,this.deck.setAttribute("elements",`${this.slideNumber} ${this.slidesOnScreen}`),this.deck.clearPanel();for(let t of Object.keys(this.data.steps)){let e=this.data.steps[t],s=document.createElement(this.cardType);s.setAttribute("side",`${this.slideSize}px`),s.style.margin=`0 ${this.slideMargin}px`,this.deck.addElement(s),s.setContent(e,this.data.viewBox,this.data.style,this.data.defs),this.slides.push(s)}this.jump(e)}}toggleDeck(){this.deck.toggle()}swipe(t){switch(t){case"left":this.deck.backward();break;case"right":this.deck.forward();break;case"up":case"down":this.deck.toggle()}}slide(t){this.deck.slide(t)}jump(t){this.deck.jump(t)}}),customElements.define("model-card",class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}).innerHTML='\n\t\t<style>\n\t\t\t@import "./styles/model-card.css";\n\t\t</style>\n\t\t<div id="wrapper" class="horizontal">\n\t\t\t<div id="card-cell" class="grid-cell"></div>\n\t\t\t<div id="info-cell" class="grid-cell">\n\t\t\t\t<div style="margin-bottom:1em">\n\t\t\t\t\t<div id="title"></div>\n\t\t\t\t\t<div id="author"></div>\n\t\t\t\t\t<div id="sheet"></div>\n\t\t\t\t</div>\n\t\t\t\t<div id="fold-it">Fold it!</div>\n\t\t\t</div>\n\t\t</div>\n\t\t',this.randomRot=10,this.pileNumber=5,this.coverCard,this.orientation,this.cardSide}connectedCallback(){this.coverPatterns=["./images/traditional_arrow.svg","./images/traditional_waves.svg","./images/traditional_hemp.svg"],this.wrapper=this.shadowRoot.querySelector("#wrapper"),this.cardPlate=this.shadowRoot.querySelector("#card-cell"),this.modelTitle=this.shadowRoot.querySelector("#title"),this.author=this.shadowRoot.querySelector("#author"),this.sheet=this.shadowRoot.querySelector("#sheet"),this.foldIt=this.shadowRoot.querySelector("#fold-it");let t=this.getAttribute("side").trim().split(" ");this.style.setProperty("--side-width",t[0]),this.style.setProperty("--side-height",t[1]),this.orientation=parseFloat(t[0])>parseFloat(t[1])?"horizontal":"vertical","horizontal"==this.orientation?this.cardSide=parseFloat(t[1]):this.cardSide=parseFloat(t[0]),this.style.setProperty("--card-side",.75*this.cardSide+"px"),this.wrapper.classList.add(this.orientation),this.listeners()}listeners(){this.foldIt.addEventListener("click",(()=>{this.contentClick()}))}contentClick(){let t=new CustomEvent("fold-it-click",{detail:{slot:this.getAttribute("slot")},bubbles:!0,composed:!0});dispatchEvent(t,!0)}setContent(t){for(let t=0;t<this.pileNumber;t++){let t=document.createElement("div");t.classList.add("card"),t.style.transform=`rotate(${this.randomRot*(Math.random()-.5)}deg)`,this.cardPlate.append(t)}if(this.coverCard=document.createElement("div"),this.coverCard.classList.add("card"),this.coverCard.style.transform=`rotate(${this.randomRot*(Math.random()-.5)}deg)`,this.cardPlate.append(this.coverCard),null!=t){let e=t?.coverImage,s=t?.viewBox,i=t?.style,o=t?.defs,n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.style.width="100%",n.style.height="100%",n.setAttribute("viewBox",s),n.append(e);let l=document.createElement("style");l.innerHTML=i,n.append(l);let h=document.createElementNS("http://www.w3.org/2000/svg","defs");h.innerHTML=o,n.append(h),this.coverCard.append(n),this.foldIt.innerHTML="Fold it!",this.modelTitle.innerHTML=`${t.title}`,this.author.innerHTML=`Author: ${t.author}`,this.sheet.innerHTML=`Sheet: ${t.sheet}`}else{let t=document.createElement("img");t.src=this.coverPatterns[Math.floor(3*Math.random(this.coverPatterns))],this.coverCard.append(t),this.foldIt.innerHTML="Add model"}}setCaption(t){this.caption.innerHTML=t}setStepNumber(t){"number"==typeof t&&(t=t.toString()),this.stepNumber=t}}),customElements.define("step-card",class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}).innerHTML='\n\t\t<style>\n\t\t\t@import "./styles/step-card.css";\n\t\t</style>\n\t\t<div id="slide">\n\t\t\t<div id="content"></div>\n\t\t\t<div id="side-tools">\n\t\t\t\t<img id="bookmark" class="side-tool" src="./images/icons/nobookmark.svg"></img>\n\t\t\t\t<img id="zoom-in" class="side-tool" src="./images/icons/zoom.svg"></img>\n\t\t\t\t<img id="jump-to" class="side-tool" src="./images/icons/shortcut.svg"></img>\n\t\t\t</div>\n\t\t</div>\n\t\t',this.randomRot=10,this.stepNumber=-1,this.subStepCount=1,this.subStep=0,this.svg}connectedCallback(){if(this.slide=this.shadowRoot.querySelector("#slide"),this.slide.style.transform=`rotate(${this.randomRot*(Math.random()-.5)}deg)`,this.hasAttribute("side")){let t=parseFloat(this.getAttribute("side"));this.style.setProperty("--side",`${t}px`),this.style.setProperty("--caption-closed",t/4+"px"),this.style.setProperty("--caption-open",t/2+"px")}let t=getComputedStyle(this);this.content=this.shadowRoot.querySelector("#content"),this.caption=document.createElement("caption-box"),this.caption.setAttribute("width",t.getPropertyValue("--side")),this.caption.setAttribute("closedHeight",t.getPropertyValue("--caption-closed")),this.caption.setAttribute("openFactor",2),this.slide.append(this.caption),this.bookmark=this.shadowRoot.querySelector("#bookmark"),this.jumpTo=this.shadowRoot.querySelector("#jump-to"),this.zoomIn=this.shadowRoot.querySelector("#zoom-in"),this.listeners()}listeners(){this.bookmark.addEventListener("click",(()=>{this.bookmarkClick()})),this.zoomIn.addEventListener("click",(()=>{this.zoomClick()}))}bookmarkClick(){let t;this.bookmark.className.includes("active")?(this.bookmark.classList.remove("active"),this.bookmark.src="./images/icons/nobookmark.svg"):(this.bookmark.classList.add("active"),this.bookmark.src="./images/icons/bookmark.svg",t=this.stepNumber);let e=new CustomEvent("set-bookmark",{detail:{step:t},bubbles:!0,composed:!0});this.dispatchEvent(e,!0)}zoomClick(){if(this.svg){let t=this.svg.cloneNode(!0);t.removeAttribute("id"),document.getElementById("zoomed-slide").setContent(t),document.getElementById("zoomed-slide").show()}}setContent(t,e,s,i){this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.style.width="100%",this.svg.style.height="100%",this.svg.setAttribute("viewBox",e);let o=document.createElement("style");o.innerHTML=s,this.svg.append(o);let n=document.createElementNS("http://www.w3.org/2000/svg","defs");n.innerHTML=i,this.svg.append(n);for(let e of t)this.svg.append(e);this.content.append(this.svg);let l=this.svg.querySelector("[jump]");if(l){let t=Number(l.getAttribute("jump"))-1;this.jumpTo.classList.add("visible"),this.jumpTo.addEventListener("click",(()=>{document.querySelector("#step-deck").jump(t)}))}let h=this.svg.querySelectorAll("[id^=step-]");this.stepNumber=Number(h[0].id.split("-")[1])+1;let a=`Step ${this.stepNumber}.`;h[0].getAttribute("caption")&&(a+=` ${h[0].getAttribute("caption")}`),this.caption.setContent(a),h[0].hasAttribute("nozoom")&&this.zoomIn.classList.add("invisible")}setCaption(t){this.caption.setContent(t)}setStepNumber(t){"number"==typeof t&&(t=t.toString()),this.stepNumber=t}}),customElements.define("caption-box",class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}).innerHTML='\n\t\t<style>\n\t\t\t@import "./styles/caption-box.css";\n\t\t</style>\n\t\t<div id="wrapper">\n\t\t\t<div id="box"></div>\n\t\t\t<img id="dots" src="./images/icons/more_dots.svg"></img>\n\t\t</div>\n\t\t',this.width,this.closedHeight,this.openFactor,this.openHeight}connectedCallback(){this.wrapper=this.shadowRoot.querySelector("#wrapper"),this.box=this.shadowRoot.querySelector("#box"),this.dots=this.shadowRoot.querySelector("#dots"),this.width=parseFloat(this.getAttribute("width")),this.closedHeight=parseFloat(this.getAttribute("closedHeight")),this.openFactor=parseFloat(this.getAttribute("openFactor")),this.openHeight=this.openFactor*this.closedHeight,this.style.height=`${this.closedHeight}px`,this.style.width=`${this.width}px`,this.style.setProperty("--closed-height",`${this.closedHeight}px`),this.style.setProperty("--open-height",`${this.openHeight}px`),this.style.setProperty("--font-size",this.closedHeight/4+"px"),this.style.setProperty("--line-height",`${this.closedHeight}px`)}listeners(){this.wrapper.addEventListener("click",(()=>{this.box.classList.toggle("open")}))}setContent(t){let e=charPerUnitLength*parseFloat(this.width)/(this.closedHeight/4);this.box.innerHTML=t,t.length>e&&(this.box.classList.add("expandable"),this.dots.style.display="block",this.listeners())}}),customElements.define("zoomed-slide",class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}).innerHTML='\n\t\t<style>\n\t\t\t@import "./styles/zoomed-slide.css";\n\t\t</style>\n\t\t<div id="background">\n\t\t\t<div id="wrapper">\n\t\t\t\t<div id="content"></div>\n\t\t\t\t<img id="close" src="./images/icons/cancel.svg"></img>\n\t\t\t\t<div id="zoom-shelf">\n\t\t\t\t\t<img id="zoom-in" src="./images/icons/zoom_in.svg"></img>\n\t\t\t\t\t<img id="zoom-out" src="./images/icons/zoom_out.svg"></img>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</div>\n\t\t'}connectedCallback(){this.position=[0,0],this.scale=1,this.maxScale=5,this.minScale=.25,this.content=this.shadowRoot.querySelector("#content"),this.closeButton=this.shadowRoot.querySelector("#close"),this.zoomInButton=this.shadowRoot.querySelector("#zoom-in"),this.zoomOutButton=this.shadowRoot.querySelector("#zoom-out"),this.listeners()}listeners(){this.closeButton.addEventListener("click",(()=>{this.hide()})),this.zoomInButton.addEventListener("click",(()=>{this.zoom(!0)})),this.zoomOutButton.addEventListener("click",(()=>{this.zoom(!1)})),window.addEventListener("move-event",(t=>{if("block"==this.style.display){let[e,s]=t.detail.raw;this.position[0]+=e,this.position[1]+="key"==t.detail.type?-s:s,this.svg.setAttribute("transform",`scale(${this.scale},${this.scale}), translate(${this.position[0]/this.scale},${this.position[1]/this.scale})`)}})),window.addEventListener("zoom-event",(t=>{"block"==this.style.display&&this.zoom(t.detail.raw<0)}))}setContent(t){this.position=[0,0],this.scale=1,this.content.innerHTML="",this.svg=t,this.content.append(this.svg),this.svg.setAttribute("transform",`scale(${this.scale},${this.scale}), translate(${this.position[0]},${this.position[1]})`)}show(){this.style.display="block"}hide(){this.style.display="none"}zoom(t){this.scale=t?Math.min(this.scale+.25,this.maxScale):Math.max(this.scale-.25,this.minScale),this.svg.setAttribute("transform",`scale(${this.scale}), translate(${this.position[0]},${this.position[1]})`)}}),customElements.define("loading-widget",class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}).innerHTML='\n\t\t<style>\n\t\t\t@import "./styles/loading-widget.css";\n\t\t</style>\n\t\t<div id="spinner">\n\t\t\t<div class="dot"></div>\n\t\t\t<div class="dot"></div>\n\t\t\t<div class="dot"></div>\n\t\t</div>\n\t\t',this.width,this.closedHeight,this.openFactor,this.openHeight}connectedCallback(){this.spinner=this.shadowRoot.querySelector("#wrapper")}listeners(){this.wrapper.addEventListener("click",(()=>{}))}})})();